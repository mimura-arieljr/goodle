import { logout } from "../utils/sessionManager.js";
import { saveToStorage } from "../utils/storageManager.js";
export function settingsView(settingsPage, mainPage) {
    // form handlers
    const settingsForm = document.getElementById("settings-form");
    const scoringCheckbox = document.getElementById("enable-scoring");
    const timerInput = document.getElementById("timer");
    const numQuestionsInput = document.getElementById("num-questions");
    // button handlers
    const settingsBtn = document.getElementById("settings-btn");
    const quitBtn = document.getElementById("quit-btn");
    const backBtn = document.getElementById("settings-back-btn");
    const darkModeBtn = document.getElementById("dark-mode-btn");
    const labelForDarkMode = document.querySelector("label[for='dark-mode-btn']");
    const menuButtons = document.querySelectorAll(".menu-btn");
    // text and background handlers
    const goodleText = document.getElementById("goodle-text");
    const settingsSavedText = document.getElementById("settings-saved-text");
    const backgroundWrap = document.querySelectorAll(".background-wrap");
    const LIGHT_MODE_BACKGROUND = 'custom-light-full';
    const DARK_MODE_BACKGROUND = 'custom-dark-full';
    const LIGHT_GRID_BACKGROUND = 'custom-light-grid-overlay';
    const DARK_GRID_BACKGROUND = 'custom-dark-grid-overlay';
    settingsBtn.addEventListener("click", () => {
        // Control pages UI
        settingsPage.classList.remove("translate-x-full");
        mainPage.classList.remove("hidden");
        mainPage.classList.add("transition-transform", "duration-300", "ease-in-out", "translate-x-[-10%]"); // Shift main-page buttons
        mainPage.classList.remove("xs:opacity-100");
        // Control buttons and text UI
        menuButtons.forEach((btn) => btn.disabled = true);
        settingsBtn.classList.add("hidden");
        goodleText?.classList.add("opacity-90");
    });
    backBtn.addEventListener("click", () => {
        settingsPage.classList.add("translate-x-full");
        mainPage.classList.remove("translate-x-[-10%]");
        mainPage.classList.add("xs:opacity-100");
        menuButtons.forEach((btn) => btn.disabled = false);
        settingsBtn.classList.remove("hidden");
        goodleText?.classList.remove("opacity-50");
    });
    darkModeBtn.addEventListener("click", (event) => {
        // Prevent default action, e.g., form submission
        event.preventDefault();
        // Toggle dark mode
        document.body.classList.toggle("dark");
        backgroundWrap.forEach((wrap) => {
            if (wrap.classList.contains(DARK_GRID_BACKGROUND)) {
                // If dark mode is present, remove it and add the other classes
                wrap.classList.remove(DARK_GRID_BACKGROUND);
                document.body.classList.remove("bg-custom-dark");
                wrap.classList.add(LIGHT_GRID_BACKGROUND);
                labelForDarkMode.textContent = "Dark Mode";
            }
            else {
                // Otherwise, add dark mode and remove the other classes
                wrap.classList.remove(LIGHT_GRID_BACKGROUND);
                document.body.classList.add("bg-custom-dark");
                wrap.classList.add(DARK_GRID_BACKGROUND);
                labelForDarkMode.textContent = "Light Mode";
            }
        });
    });
    settingsForm.addEventListener("submit", (e) => {
        e.preventDefault();
        // Save values to sessionStorage
        saveToStorage("enableScoring", scoringCheckbox.checked.toString());
        saveToStorage("timePerQuestion", timerInput.value);
        saveToStorage("numberOfQuestions", numQuestionsInput.value);
        // Show and hide the text to inform user
        settingsSavedText?.classList.remove("hidden");
        setTimeout(() => {
            settingsSavedText?.classList.add("hidden");
        }, 2000);
    });
    quitBtn.addEventListener("click", () => {
        // TODO: Add diaglog box to verify logout
        logout();
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dGluZ3NWaWV3LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3ZpZXdzL3NldHRpbmdzVmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDcEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBRTNELE1BQU0sVUFBVSxZQUFZLENBQUMsWUFBeUIsRUFBRSxRQUFxQjtJQUN6RSxnQkFBZ0I7SUFDaEIsTUFBTSxZQUFZLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQW9CLENBQUM7SUFDakYsTUFBTSxlQUFlLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBcUIsQ0FBQztJQUN0RixNQUFNLFVBQVUsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBcUIsQ0FBQztJQUN4RSxNQUFNLGlCQUFpQixHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFxQixDQUFDO0lBRXZGLGtCQUFrQjtJQUNsQixNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLGNBQWMsQ0FBc0IsQ0FBQztJQUNqRixNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBc0IsQ0FBQztJQUN6RSxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLG1CQUFtQixDQUFzQixDQUFDO0lBQ2xGLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFzQixDQUFDO0lBQ2xGLE1BQU0sZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO0lBQzlFLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQWtDLENBQUM7SUFFNUYsK0JBQStCO0lBQy9CLE1BQU0sVUFBVSxHQUFHLFFBQVEsQ0FB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LFNBQVMsQ0FBQyxNQUFNLENBQUMscUJBQXFCLENBQUMsQ0FBQztnQkFDN0MsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7Z0JBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLG9CQUFvQixDQUFDLENBQUM7Z0JBRXpDLGdCQUFpQixDQUFDLFdBQVcsR0FBRyxZQUFZLENBQUM7WUFDakQsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxZQUFZLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUU7UUFDMUMsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBRW5CLGdDQUFnQztRQUNoQyxhQUFhLENBQUMsZUFBZSxFQUFFLGVBQWUsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUNuRSxhQUFhLENBQUMsaUJBQWlCLEVBQUUsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25ELGFBQWEsQ0FBQyxtQkFBbUIsRUFBRSxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUU1RCx3Q0FBd0M7UUFDeEMsaUJBQWlCLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM5QyxVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ1osaUJBQWlCLEVBQUUsU0FBUyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUMvQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDYixDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO1FBQ25DLHlDQUF5QztRQUN6QyxNQUFNLEVBQUUsQ0FBQztJQUNiLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvZ291dCB9IGZyb20gXCIuLi91dGlscy9zZXNzaW9uTWFuYWdlci5qc1wiO1xuaW1wb3J0IHsgc2F2ZVRvU3RvcmFnZSB9IGZyb20gXCIuLi91dGlscy9zdG9yYWdlTWFuYWdlci5qc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gc2V0dGluZ3NWaWV3KHNldHRpbmdzUGFnZTogSFRNTEVsZW1lbnQsIG1haW5QYWdlOiBIVE1MRWxlbWVudCkge1xuICAgIC8vIGZvcm0gaGFuZGxlcnNcbiAgICBjb25zdCBzZXR0aW5nc0Zvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNldHRpbmdzLWZvcm1cIikgYXMgSFRNTEZvcm1FbGVtZW50O1xuICAgIGNvbnN0IHNjb3JpbmdDaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZW5hYmxlLXNjb3JpbmdcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICBjb25zdCB0aW1lcklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aW1lclwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIGNvbnN0IG51bVF1ZXN0aW9uc0lucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJudW0tcXVlc3Rpb25zXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAvLyBidXR0b24gaGFuZGxlcnNcbiAgICBjb25zdCBzZXR0aW5nc0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2V0dGluZ3MtYnRuXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIGNvbnN0IHF1aXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInF1aXQtYnRuXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIGNvbnN0IGJhY2tCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNldHRpbmdzLWJhY2stYnRuXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIGNvbnN0IGRhcmtNb2RlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkYXJrLW1vZGUtYnRuXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIGNvbnN0IGxhYmVsRm9yRGFya01vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibGFiZWxbZm9yPSdkYXJrLW1vZGUtYnRuJ11cIik7XG4gICAgY29uc3QgbWVudUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1lbnUtYnRuXCIpIGFzIE5vZGVMaXN0T2Y8SFRNTEJ1dHRvbkVsZW1lbnQ+O1xuXG4gICAgLy8gdGV4dCBhbmQgYmFja2dyb3VuZCBoYW5kbGVyc1xuICAgIGNvbnN0IGdvb2RsZVRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdvb2RsZS10ZXh0XCIpO1xuICAgIGNvbnN0IHNldHRpbmdzU2F2ZWRUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZXR0aW5ncy1zYXZlZC10ZXh0XCIpO1xuICAgIGNvbnN0IGJhY2tncm91bmRXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5iYWNrZ3JvdW5kLXdyYXBcIikgYXMgTm9kZUxpc3RPZjxIVE1MRWxlbWVudD47XG5cbiAgICBjb25zdCBMSUdIVF9NT0RFX0JBQ0tHUk9VTkQgPSAnY3VzdG9tLWxpZ2h0LWZ1bGwnXG4gICAgY29uc3QgREFSS19NT0RFX0JBQ0tHUk9VTkQgPSAnY3VzdG9tLWRhcmstZnVsbCdcbiAgICBjb25zdCBMSUdIVF9HUklEX0JBQ0tHUk9VTkQgPSAnY3VzdG9tLWxpZ2h0LWdyaWQtb3ZlcmxheSdcbiAgICBjb25zdCBEQVJLX0dSSURfQkFDS0dST1VORCA9ICdjdXN0b20tZGFyay1ncmlkLW92ZXJsYXknXG5cbiAgICBzZXR0aW5nc0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAvLyBDb250cm9sIHBhZ2VzIFVJXG4gICAgICAgIHNldHRpbmdzUGFnZS5jbGFzc0xpc3QucmVtb3ZlKFwidHJhbnNsYXRlLXgtZnVsbFwiKTtcbiAgICAgICAgbWFpblBhZ2UuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICAgICAgbWFpblBhZ2UuY2xhc3NMaXN0LmFkZChcInRyYW5zaXRpb24tdHJhbnNmb3JtXCIsIFwiZHVyYXRpb24tMzAwXCIsIFwiZWFzZS1pbi1vdXRcIiwgXCJ0cmFuc2xhdGUteC1bLTEwJV1cIik7IC8vIFNoaWZ0IG1haW4tcGFnZSBidXR0b25zXG4gICAgICAgIG1haW5QYWdlLmNsYXNzTGlzdC5yZW1vdmUoXCJ4czpvcGFjaXR5LTEwMFwiKTtcblxuICAgICAgICAvLyBDb250cm9sIGJ1dHRvbnMgYW5kIHRleHQgVUlcbiAgICAgICAgbWVudUJ1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiBidG4uZGlzYWJsZWQgPSB0cnVlKTtcbiAgICAgICAgc2V0dGluZ3NCdG4uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICAgICAgZ29vZGxlVGV4dD8uY2xhc3NMaXN0LmFkZChcIm9wYWNpdHktOTBcIik7XG4gICAgfSk7XG5cbiAgICBiYWNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHNldHRpbmdzUGFnZS5jbGFzc0xpc3QuYWRkKFwidHJhbnNsYXRlLXgtZnVsbFwiKTtcbiAgICAgICAgbWFpblBhZ2UuY2xhc3NMaXN0LnJlbW92ZShcInRyYW5zbGF0ZS14LVstMTAlXVwiKTtcbiAgICAgICAgbWFpblBhZ2UuY2xhc3NMaXN0LmFkZChcInhzOm9wYWNpdHktMTAwXCIpO1xuXG4gICAgICAgIG1lbnVCdXR0b25zLmZvckVhY2goKGJ0bikgPT4gYnRuLmRpc2FibGVkID0gZmFsc2UpO1xuICAgICAgICBzZXR0aW5nc0J0bi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICAgICAgICBnb29kbGVUZXh0Py5jbGFzc0xpc3QucmVtb3ZlKFwib3BhY2l0eS01MFwiKTtcbiAgICB9KTtcblxuICAgIGRhcmtNb2RlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgLy8gUHJldmVudCBkZWZhdWx0IGFjdGlvbiwgZS5nLiwgZm9ybSBzdWJtaXNzaW9uXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgLy8gVG9nZ2xlIGRhcmsgbW9kZVxuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoXCJkYXJrXCIpO1xuICAgICAgICBiYWNrZ3JvdW5kV3JhcC5mb3JFYWNoKCh3cmFwKSA9PiB7XG4gICAgICAgICAgICBpZiAod3JhcC5jbGFzc0xpc3QuY29udGFpbnMoREFSS19HUklEX0JBQ0tHUk9VTkQpKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgZGFyayBtb2RlIGlzIHByZXNlbnQsIHJlbW92ZSBpdCBhbmQgYWRkIHRoZSBvdGhlciBjbGFzc2VzXG4gICAgICAgICAgICAgICAgd3JhcC5jbGFzc0xpc3QucmVtb3ZlKERBUktfR1JJRF9CQUNLR1JPVU5EKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJiZy1jdXN0b20tZGFya1wiKTtcbiAgICAgICAgICAgICAgICB3cmFwLmNsYXNzTGlzdC5hZGQoTElHSFRfR1JJRF9CQUNLR1JPVU5EKTtcblxuICAgICAgICAgICAgICAgIGxhYmVsRm9yRGFya01vZGUhLnRleHRDb250ZW50ID0gXCJEYXJrIE1vZGVcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBhZGQgZGFyayBtb2RlIGFuZCByZW1vdmUgdGhlIG90aGVyIGNsYXNzZXNcbiAgICAgICAgICAgICAgICB3cmFwLmNsYXNzTGlzdC5yZW1vdmUoTElHSFRfR1JJRF9CQUNLR1JPVU5EKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJiZy1jdXN0b20tZGFya1wiKTtcbiAgICAgICAgICAgICAgICB3cmFwLmNsYXNzTGlzdC5hZGQoREFSS19HUklEX0JBQ0tHUk9VTkQpO1xuXG4gICAgICAgICAgICAgICAgbGFiZWxGb3JEYXJrTW9kZSEudGV4dENvbnRlbnQgPSBcIkxpZ2h0IE1vZGVcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBzZXR0aW5nc0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgLy8gU2F2ZSB2YWx1ZXMgdG8gc2Vzc2lvblN0b3JhZ2VcbiAgICAgICAgc2F2ZVRvU3RvcmFnZShcImVuYWJsZVNjb3JpbmdcIiwgc2NvcmluZ0NoZWNrYm94LmNoZWNrZWQudG9TdHJpbmcoKSk7XG4gICAgICAgIHNhdmVUb1N0b3JhZ2UoXCJ0aW1lUGVyUXVlc3Rpb25cIiwgdGltZXJJbnB1dC52YWx1ZSk7XG4gICAgICAgIHNhdmVUb1N0b3JhZ2UoXCJudW1iZXJPZlF1ZXN0aW9uc1wiLCBudW1RdWVzdGlvbnNJbnB1dC52YWx1ZSk7XG5cbiAgICAgICAgLy8gU2hvdyBhbmQgaGlkZSB0aGUgdGV4dCB0byBpbmZvcm0gdXNlclxuICAgICAgICBzZXR0aW5nc1NhdmVkVGV4dD8uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBzZXR0aW5nc1NhdmVkVGV4dD8uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICAgICAgfSwgMjAwMCk7XG4gICAgfSk7XG5cbiAgICBxdWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIFRPRE86IEFkZCBkaWFnbG9nIGJveCB0byB2ZXJpZnkgbG9nb3V0XG4gICAgICAgIGxvZ291dCgpO1xuICAgIH0pO1xufVxuIl19