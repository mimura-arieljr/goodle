import { logout } from "../utils/sessionManager.js";
import { saveToStorage } from "../utils/storageManager.js";
export function settingsView(settingsPage, mainPage) {
    // form handlers
    const settingsForm = document.getElementById("settings-form");
    const scoringCheckbox = document.getElementById("enable-scoring");
    const timerInput = document.getElementById("timer");
    const numQuestionsInput = document.getElementById("num-questions");
    // button handlers
    const settingsBtn = document.getElementById("settings-btn");
    const quitBtn = document.getElementById("quit-btn");
    const backBtn = document.getElementById("settings-back-btn");
    const darkModeBtn = document.getElementById("dark-mode-btn");
    const labelForDarkMode = document.querySelector("label[for='dark-mode-btn']");
    const menuButtons = document.querySelectorAll(".menu-btn");
    // text and background handlers
    const goodleText = document.getElementById("goodle-text");
    const settingsSavedText = document.getElementById("settings-saved-text");
    const backgroundWrap = document.querySelectorAll(".background-wrap");
    const LIGHT_MODE_BACKGROUND = 'custom-light-full';
    const DARK_MODE_BACKGROUND = 'custom-dark-full';
    const LIGHT_GRID_BACKGROUND = 'custom-light-grid-overlay';
    const DARK_GRID_BACKGROUND = 'custom-dark-grid-overlay';
    settingsBtn.addEventListener("click", () => {
        // Control pages UI
        settingsPage.classList.remove("translate-x-full");
        mainPage.classList.remove("hidden");
        mainPage.classList.add("transition-transform", "duration-300", "ease-in-out", "translate-x-[-10%]"); // Shift main-page buttons
        mainPage.classList.remove("xs:opacity-100");
        // Control buttons and text UI
        menuButtons.forEach((btn) => btn.disabled = true);
        menuButtons.forEach((btn) => btn.classList.add("opacity-50"));
        goodleText?.classList.add("opacity-50");
    });
    backBtn.addEventListener("click", () => {
        settingsPage.classList.add("translate-x-full");
        mainPage.classList.remove("translate-x-[-10%]");
        mainPage.classList.add("xs:opacity-100");
        menuButtons.forEach((btn) => btn.disabled = false);
        menuButtons.forEach((btn) => btn.classList.remove("opacity-50"));
        goodleText?.classList.remove("opacity-50");
    });
    darkModeBtn.addEventListener("click", (event) => {
        // Prevent default action, e.g., form submission
        event.preventDefault();
        // Toggle dark mode
        document.body.classList.toggle("dark");
        backgroundWrap.forEach((wrap) => {
            if (wrap.classList.contains(DARK_GRID_BACKGROUND)) {
                // If dark mode is present, remove it and add the other classes
                wrap.classList.remove(DARK_GRID_BACKGROUND);
                document.body.classList.remove("bg-custom-dark");
                wrap.classList.add(LIGHT_GRID_BACKGROUND);
                labelForDarkMode.textContent = "Dark Mode";
            }
            else {
                // Otherwise, add dark mode and remove the other classes
                wrap.classList.remove(LIGHT_GRID_BACKGROUND);
                document.body.classList.add("bg-custom-dark");
                wrap.classList.add(DARK_GRID_BACKGROUND);
                labelForDarkMode.textContent = "Light Mode";
            }
        });
    });
    settingsForm.addEventListener("submit", (e) => {
        e.preventDefault();
        // Save values to sessionStorage
        saveToStorage("enableScoring", scoringCheckbox.checked.toString());
        saveToStorage("timePerQuestion", timerInput.value);
        saveToStorage("numberOfQuestions", numQuestionsInput.value);
        // Show and hide the text to inform user
        settingsSavedText?.classList.remove("hidden");
        setTimeout(() => {
            settingsSavedText?.classList.add("hidden");
        }, 3000);
    });
    quitBtn.addEventListener("click", () => {
        // TODO: Add diaglog box to verify logout
        logout();
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dGluZ3NWaWV3LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3ZpZXdzL3NldHRpbmdzVmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDcEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBRTNELE1BQU0sVUFBVSxZQUFZLENBQUMsWUFBeUIsRUFBRSxRQUFxQjtJQUN6RSxnQkFBZ0I7SUFDaEIsTUFBTSxZQUFZLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQW9CLENBQUM7SUFDakYsTUFBTSxlQUFlLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBcUIsQ0FBQztJQUN0RixNQUFNLFVBQVUsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBcUIsQ0FBQztJQUN4RSxNQUFNLGlCQUFpQixHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFxQixDQUFDO0lBRXZGLGtCQUFrQjtJQUNsQixNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLGNBQWMsQ0FBc0IsQ0FBQztJQUNqRixNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBc0IsQ0FBQztJQUN6RSxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLG1CQUFtQixDQUFzQixDQUFDO0lBQ2xGLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFzQixDQUFDO0lBQ2xGLE1BQU0sZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO0lBQzlFLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQWtDLENBQUM7SUFFNUYsK0JBQStCO0lBQy9CLE1BQU0sVUFBVSxHQUFHLFFBQVEsQ0FB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YixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBsb2dvdXQgfSBmcm9tIFwiLi4vdXRpbHMvc2Vzc2lvbk1hbmFnZXIuanNcIjtcbmltcG9ydCB7IHNhdmVUb1N0b3JhZ2UgfSBmcm9tIFwiLi4vdXRpbHMvc3RvcmFnZU1hbmFnZXIuanNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHNldHRpbmdzVmlldyhzZXR0aW5nc1BhZ2U6IEhUTUxFbGVtZW50LCBtYWluUGFnZTogSFRNTEVsZW1lbnQpIHtcbiAgICAvLyBmb3JtIGhhbmRsZXJzXG4gICAgY29uc3Qgc2V0dGluZ3NGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZXR0aW5ncy1mb3JtXCIpIGFzIEhUTUxGb3JtRWxlbWVudDtcbiAgICBjb25zdCBzY29yaW5nQ2hlY2tib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVuYWJsZS1zY29yaW5nXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgY29uc3QgdGltZXJJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGltZXJcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICBjb25zdCBudW1RdWVzdGlvbnNJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibnVtLXF1ZXN0aW9uc1wiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXG4gICAgLy8gYnV0dG9uIGhhbmRsZXJzXG4gICAgY29uc3Qgc2V0dGluZ3NCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNldHRpbmdzLWJ0blwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBjb25zdCBxdWl0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJxdWl0LWJ0blwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBjb25zdCBiYWNrQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZXR0aW5ncy1iYWNrLWJ0blwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBjb25zdCBkYXJrTW9kZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGFyay1tb2RlLWJ0blwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBjb25zdCBsYWJlbEZvckRhcmtNb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj0nZGFyay1tb2RlLWJ0biddXCIpO1xuICAgIGNvbnN0IG1lbnVCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tZW51LWJ0blwiKSBhcyBOb2RlTGlzdE9mPEhUTUxCdXR0b25FbGVtZW50PjtcblxuICAgIC8vIHRleHQgYW5kIGJhY2tncm91bmQgaGFuZGxlcnNcbiAgICBjb25zdCBnb29kbGVUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnb29kbGUtdGV4dFwiKTtcbiAgICBjb25zdCBzZXR0aW5nc1NhdmVkVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2V0dGluZ3Mtc2F2ZWQtdGV4dFwiKTtcbiAgICBjb25zdCBiYWNrZ3JvdW5kV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmFja2dyb3VuZC13cmFwXCIpIGFzIE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+O1xuXG4gICAgY29uc3QgTElHSFRfTU9ERV9CQUNLR1JPVU5EID0gJ2N1c3RvbS1saWdodC1mdWxsJ1xuICAgIGNvbnN0IERBUktfTU9ERV9CQUNLR1JPVU5EID0gJ2N1c3RvbS1kYXJrLWZ1bGwnXG4gICAgY29uc3QgTElHSFRfR1JJRF9CQUNLR1JPVU5EID0gJ2N1c3RvbS1saWdodC1ncmlkLW92ZXJsYXknXG4gICAgY29uc3QgREFSS19HUklEX0JBQ0tHUk9VTkQgPSAnY3VzdG9tLWRhcmstZ3JpZC1vdmVybGF5J1xuXG4gICAgc2V0dGluZ3NCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgLy8gQ29udHJvbCBwYWdlcyBVSVxuICAgICAgICBzZXR0aW5nc1BhZ2UuY2xhc3NMaXN0LnJlbW92ZShcInRyYW5zbGF0ZS14LWZ1bGxcIik7XG4gICAgICAgIG1haW5QYWdlLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gICAgICAgIG1haW5QYWdlLmNsYXNzTGlzdC5hZGQoXCJ0cmFuc2l0aW9uLXRyYW5zZm9ybVwiLCBcImR1cmF0aW9uLTMwMFwiLCBcImVhc2UtaW4tb3V0XCIsIFwidHJhbnNsYXRlLXgtWy0xMCVdXCIpOyAvLyBTaGlmdCBtYWluLXBhZ2UgYnV0dG9uc1xuICAgICAgICBtYWluUGFnZS5jbGFzc0xpc3QucmVtb3ZlKFwieHM6b3BhY2l0eS0xMDBcIik7XG5cbiAgICAgICAgLy8gQ29udHJvbCBidXR0b25zIGFuZCB0ZXh0IFVJXG4gICAgICAgIG1lbnVCdXR0b25zLmZvckVhY2goKGJ0bikgPT4gYnRuLmRpc2FibGVkID0gdHJ1ZSk7XG4gICAgICAgIG1lbnVCdXR0b25zLmZvckVhY2goKGJ0bikgPT4gYnRuLmNsYXNzTGlzdC5hZGQoXCJvcGFjaXR5LTUwXCIpKTtcbiAgICAgICAgZ29vZGxlVGV4dD8uY2xhc3NMaXN0LmFkZChcIm9wYWNpdHktNTBcIik7XG4gICAgfSk7XG5cbiAgICBiYWNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHNldHRpbmdzUGFnZS5jbGFzc0xpc3QuYWRkKFwidHJhbnNsYXRlLXgtZnVsbFwiKTtcbiAgICAgICAgbWFpblBhZ2UuY2xhc3NMaXN0LnJlbW92ZShcInRyYW5zbGF0ZS14LVstMTAlXVwiKTtcbiAgICAgICAgbWFpblBhZ2UuY2xhc3NMaXN0LmFkZChcInhzOm9wYWNpdHktMTAwXCIpO1xuXG4gICAgICAgIG1lbnVCdXR0b25zLmZvckVhY2goKGJ0bikgPT4gYnRuLmRpc2FibGVkID0gZmFsc2UpO1xuICAgICAgICBtZW51QnV0dG9ucy5mb3JFYWNoKChidG4pID0+IGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwib3BhY2l0eS01MFwiKSk7XG4gICAgICAgIGdvb2RsZVRleHQ/LmNsYXNzTGlzdC5yZW1vdmUoXCJvcGFjaXR5LTUwXCIpO1xuICAgIH0pO1xuXG4gICAgZGFya01vZGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgICAvLyBQcmV2ZW50IGRlZmF1bHQgYWN0aW9uLCBlLmcuLCBmb3JtIHN1Ym1pc3Npb25cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBUb2dnbGUgZGFyayBtb2RlXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZShcImRhcmtcIik7XG4gICAgICAgIGJhY2tncm91bmRXcmFwLmZvckVhY2goKHdyYXApID0+IHtcbiAgICAgICAgICAgIGlmICh3cmFwLmNsYXNzTGlzdC5jb250YWlucyhEQVJLX0dSSURfQkFDS0dST1VORCkpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBkYXJrIG1vZGUgaXMgcHJlc2VudCwgcmVtb3ZlIGl0IGFuZCBhZGQgdGhlIG90aGVyIGNsYXNzZXNcbiAgICAgICAgICAgICAgICB3cmFwLmNsYXNzTGlzdC5yZW1vdmUoREFSS19HUklEX0JBQ0tHUk9VTkQpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShcImJnLWN1c3RvbS1kYXJrXCIpO1xuICAgICAgICAgICAgICAgIHdyYXAuY2xhc3NMaXN0LmFkZChMSUdIVF9HUklEX0JBQ0tHUk9VTkQpO1xuXG4gICAgICAgICAgICAgICAgbGFiZWxGb3JEYXJrTW9kZSEudGV4dENvbnRlbnQgPSBcIkRhcmsgTW9kZVwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIGFkZCBkYXJrIG1vZGUgYW5kIHJlbW92ZSB0aGUgb3RoZXIgY2xhc3Nlc1xuICAgICAgICAgICAgICAgIHdyYXAuY2xhc3NMaXN0LnJlbW92ZShMSUdIVF9HUklEX0JBQ0tHUk9VTkQpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImJnLWN1c3RvbS1kYXJrXCIpO1xuICAgICAgICAgICAgICAgIHdyYXAuY2xhc3NMaXN0LmFkZChEQVJLX0dSSURfQkFDS0dST1VORCk7XG5cbiAgICAgICAgICAgICAgICBsYWJlbEZvckRhcmtNb2RlIS50ZXh0Q29udGVudCA9IFwiTGlnaHQgTW9kZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIHNldHRpbmdzRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBTYXZlIHZhbHVlcyB0byBzZXNzaW9uU3RvcmFnZVxuICAgICAgICBzYXZlVG9TdG9yYWdlKFwiZW5hYmxlU2NvcmluZ1wiLCBzY29yaW5nQ2hlY2tib3guY2hlY2tlZC50b1N0cmluZygpKTtcbiAgICAgICAgc2F2ZVRvU3RvcmFnZShcInRpbWVQZXJRdWVzdGlvblwiLCB0aW1lcklucHV0LnZhbHVlKTtcbiAgICAgICAgc2F2ZVRvU3RvcmFnZShcIm51bWJlck9mUXVlc3Rpb25zXCIsIG51bVF1ZXN0aW9uc0lucHV0LnZhbHVlKTtcblxuICAgICAgICAvLyBTaG93IGFuZCBoaWRlIHRoZSB0ZXh0IHRvIGluZm9ybSB1c2VyXG4gICAgICAgIHNldHRpbmdzU2F2ZWRUZXh0Py5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHNldHRpbmdzU2F2ZWRUZXh0Py5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgICAgICB9LCAzMDAwKTtcbiAgICB9KTtcblxuICAgIHF1aXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgLy8gVE9ETzogQWRkIGRpYWdsb2cgYm94IHRvIHZlcmlmeSBsb2dvdXRcbiAgICAgICAgbG9nb3V0KCk7XG4gICAgfSk7XG59XG4iXX0=