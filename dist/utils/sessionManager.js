import { removeFromStorage, saveToStorage, getFromStorage } from "./storageManager.js";
const SESSION_DURATION = 1000 * 60 * 30;
const encodeSession = (timestamp) => btoa(timestamp.toString()); // Base64 encode
const decodeSession = (encoded) => parseInt(atob(encoded));
export const login = () => {
    const now = Date.now();
    removeFromStorage("userIsIn");
    saveToStorage("userIsIn", encodeSession(now));
};
export const isSessionValid = () => {
    const encoded = getFromStorage("userIsIn");
    if (!encoded)
        return false;
    const now = Date.now();
    return now - decodeSession(encoded) < SESSION_DURATION;
};
export const validateSession = () => {
    if (!isSessionValid()) {
        logout();
    }
};
export const logout = () => {
    sessionStorage.clear();
    window.location.reload();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Vzc2lvbk1hbmFnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvc2Vzc2lvbk1hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGFBQWEsRUFBRSxjQUFjLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUV2RixNQUFNLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDO0FBRXhDLE1BQU0sYUFBYSxHQUFHLENBQUMsU0FBaUIsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCO0FBQ3pGLE1BQU0sYUFBYSxHQUFHLENBQUMsT0FBZSxFQUFFLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7QUFFbkUsTUFBTSxDQUFDLE1BQU0sS0FBSyxHQUFHLEdBQUcsRUFBRTtJQUN0QixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDdkIsaUJBQWlCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDOUIsYUFBYSxDQUFDLFVBQVUsRUFBRSxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNsRCxDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsR0FBRyxFQUFFO0lBQy9CLE1BQU0sT0FBTyxHQUFHLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUMzQyxJQUFJLENBQUMsT0FBTztRQUFFLE9BQU8sS0FBSyxDQUFDO0lBRTNCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN2QixPQUFPLEdBQUcsR0FBRyxhQUFhLENBQUMsT0FBTyxDQUFDLEdBQUcsZ0JBQWdCLENBQUM7QUFDM0QsQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFHLEdBQUcsRUFBRTtJQUNoQyxJQUFJLENBQUMsY0FBYyxFQUFFLEVBQUUsQ0FBQztRQUNwQixNQUFNLEVBQUUsQ0FBQztJQUNiLENBQUM7QUFDTCxDQUFDLENBQUE7QUFFRCxNQUFNLENBQUMsTUFBTSxNQUFNLEdBQUcsR0FBRyxFQUFFO0lBQ3ZCLGNBQWMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN2QixNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQzdCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbW92ZUZyb21TdG9yYWdlLCBzYXZlVG9TdG9yYWdlLCBnZXRGcm9tU3RvcmFnZSB9IGZyb20gXCIuL3N0b3JhZ2VNYW5hZ2VyLmpzXCI7XG5cbmNvbnN0IFNFU1NJT05fRFVSQVRJT04gPSAxMDAwICogNjAgKiAzMDtcblxuY29uc3QgZW5jb2RlU2Vzc2lvbiA9ICh0aW1lc3RhbXA6IG51bWJlcikgPT4gYnRvYSh0aW1lc3RhbXAudG9TdHJpbmcoKSk7IC8vIEJhc2U2NCBlbmNvZGVcbmNvbnN0IGRlY29kZVNlc3Npb24gPSAoZW5jb2RlZDogc3RyaW5nKSA9PiBwYXJzZUludChhdG9iKGVuY29kZWQpKTtcblxuZXhwb3J0IGNvbnN0IGxvZ2luID0gKCkgPT4ge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgcmVtb3ZlRnJvbVN0b3JhZ2UoXCJ1c2VySXNJblwiKTtcbiAgICBzYXZlVG9TdG9yYWdlKFwidXNlcklzSW5cIiwgZW5jb2RlU2Vzc2lvbihub3cpKTtcbn07XG5cbmV4cG9ydCBjb25zdCBpc1Nlc3Npb25WYWxpZCA9ICgpID0+IHtcbiAgICBjb25zdCBlbmNvZGVkID0gZ2V0RnJvbVN0b3JhZ2UoXCJ1c2VySXNJblwiKTtcbiAgICBpZiAoIWVuY29kZWQpIHJldHVybiBmYWxzZTtcblxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuIG5vdyAtIGRlY29kZVNlc3Npb24oZW5jb2RlZCkgPCBTRVNTSU9OX0RVUkFUSU9OO1xufTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlU2Vzc2lvbiA9ICgpID0+IHtcbiAgICBpZiAoIWlzU2Vzc2lvblZhbGlkKCkpIHtcbiAgICAgICAgbG9nb3V0KCk7XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgbG9nb3V0ID0gKCkgPT4ge1xuICAgIHNlc3Npb25TdG9yYWdlLmNsZWFyKCk7XG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xufTsiXX0=