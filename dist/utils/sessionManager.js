import { removeFromStorage, saveToStorage, getFromStorage } from "./storageManager.js";
const SESSION_DURATION = 1000 * 60 * 30;
const encodeSession = (timestamp) => btoa(timestamp.toString()); // Base64 encode
const decodeSession = (encoded) => parseInt(atob(encoded));
export const login = () => {
    const now = Date.now();
    removeFromStorage("userIsIn");
    saveToStorage("userIsIn", encodeSession(now));
};
export const isSessionValid = () => {
    const encoded = getFromStorage("userIsIn");
    if (!encoded)
        return false;
    const now = Date.now();
    // console.log(decodeSession(encoded));
    return now - decodeSession(encoded) < SESSION_DURATION;
};
export const validateSession = () => {
    if (!isSessionValid()) {
        logout();
    }
};
export const logout = () => {
    sessionStorage.clear();
    window.location.reload();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Vzc2lvbk1hbmFnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvc2Vzc2lvbk1hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGFBQWEsRUFBRSxjQUFjLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUV2RixNQUFNLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDO0FBRXhDLE1BQU0sYUFBYSxHQUFHLENBQUMsU0FBaUIsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCO0FBQ3pGLE1BQU0sYUFBYSxHQUFHLENBQUMsT0FBZSxFQUFFLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7QUFFbkUsTUFBTSxDQUFDLE1BQU0sS0FBSyxHQUFHLEdBQUcsRUFBRTtJQUN0QixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDdkIsaUJBQWlCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDOUIsYUFBYSxDQUFDLFVBQVUsRUFBRSxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNsRCxDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsR0FBRyxFQUFFO0lBQy9CLE1BQU0sT0FBTyxHQUFHLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUMzQyxJQUFJLENBQUMsT0FBTztRQUFFLE9BQU8sS0FBSyxDQUFDO0lBRTNCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN2Qix1Q0FBdUM7SUFDdkMsT0FBTyxHQUFHLEdBQUcsYUFBYSxDQUFDLE9BQU8sQ0FBQyxHQUFHLGdCQUFnQixDQUFDO0FBQzNELENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBRyxHQUFHLEVBQUU7SUFDaEMsSUFBSSxDQUFDLGNBQWMsRUFBRSxFQUFFLENBQUM7UUFDcEIsTUFBTSxFQUFFLENBQUM7SUFDYixDQUFDO0FBQ0wsQ0FBQyxDQUFBO0FBRUQsTUFBTSxDQUFDLE1BQU0sTUFBTSxHQUFHLEdBQUcsRUFBRTtJQUN2QixjQUFjLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDdkIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUM3QixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW1vdmVGcm9tU3RvcmFnZSwgc2F2ZVRvU3RvcmFnZSwgZ2V0RnJvbVN0b3JhZ2UgfSBmcm9tIFwiLi9zdG9yYWdlTWFuYWdlci5qc1wiO1xuXG5jb25zdCBTRVNTSU9OX0RVUkFUSU9OID0gMTAwMCAqIDYwICogMzA7XG5cbmNvbnN0IGVuY29kZVNlc3Npb24gPSAodGltZXN0YW1wOiBudW1iZXIpID0+IGJ0b2EodGltZXN0YW1wLnRvU3RyaW5nKCkpOyAvLyBCYXNlNjQgZW5jb2RlXG5jb25zdCBkZWNvZGVTZXNzaW9uID0gKGVuY29kZWQ6IHN0cmluZykgPT4gcGFyc2VJbnQoYXRvYihlbmNvZGVkKSk7XG5cbmV4cG9ydCBjb25zdCBsb2dpbiA9ICgpID0+IHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIHJlbW92ZUZyb21TdG9yYWdlKFwidXNlcklzSW5cIik7XG4gICAgc2F2ZVRvU3RvcmFnZShcInVzZXJJc0luXCIsIGVuY29kZVNlc3Npb24obm93KSk7XG59O1xuXG5leHBvcnQgY29uc3QgaXNTZXNzaW9uVmFsaWQgPSAoKSA9PiB7XG4gICAgY29uc3QgZW5jb2RlZCA9IGdldEZyb21TdG9yYWdlKFwidXNlcklzSW5cIik7XG4gICAgaWYgKCFlbmNvZGVkKSByZXR1cm4gZmFsc2U7XG5cbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIC8vIGNvbnNvbGUubG9nKGRlY29kZVNlc3Npb24oZW5jb2RlZCkpO1xuICAgIHJldHVybiBub3cgLSBkZWNvZGVTZXNzaW9uKGVuY29kZWQpIDwgU0VTU0lPTl9EVVJBVElPTjtcbn07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZVNlc3Npb24gPSAoKSA9PiB7XG4gICAgaWYgKCFpc1Nlc3Npb25WYWxpZCgpKSB7XG4gICAgICAgIGxvZ291dCgpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGxvZ291dCA9ICgpID0+IHtcbiAgICBzZXNzaW9uU3RvcmFnZS5jbGVhcigpO1xuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbn07Il19